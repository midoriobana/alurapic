"use strict";(self.webpackChunkalurapic=self.webpackChunkalurapic||[]).push([[40],{2040:(V,d,a)=>{a.r(d),a.d(d,{HomeModule:()=>P});var c=a(6895),i=a(433),l=a(6211),Z=a(6479),e=a(8256),f=a(9797);let g=(()=>{class r{constructor(t,n){this.userService=t,this.router=n}canActivate(t,n){return!this.userService.isLogged()||(this.router.navigate(["user",this.userService.getUserName()]),!1)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(f.K),e.LFG(l.F0))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),k=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-home"]],decls:6,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-md-6","mb-2"],["src","./assets/images/home.jpg","alt","Welcome",1,"img-fluid","d-none","d-sm-block"],[1,"col-md-6"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"img",3),e.qZA(),e.TgZ(4,"div",4),e._UZ(5,"router-outlet"),e.qZA()()())},dependencies:[l.lC],encapsulation:2}),r})();var m=a(2340),T=a(8505),v=a(529);let F=(()=>{class r{constructor(t,n){this.http=t,this.userService=n}authenticate(t,n){return this.http.post(`${m.N.API_URL}/user/login`,{userName:t,password:n},{observe:"response"}).pipe((0,T.b)(s=>{const u=s.headers.get("x-access-token");this.userService.setToken(u)}))}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(v.eN),e.LFG(f.K))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),U=(()=>{class r{constructor(t){this.platformId=t}isPlatformBrowser(){return(0,c.NF)(this.platformId)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(e.Lbi))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var h=a(2889);const w=["userNameInput"],C=function(){return["signup"]};let y=(()=>{class r{constructor(t,n,s,u,G){this.fb=t,this.authService=n,this.router=s,this.platformDetectorService=u,this.activatedRoute=G}ngOnInit(){this.activatedRoute.queryParams.subscribe(t=>{this.fromUrl=t.fromUrl}),this.loginForm=this.fb.group({userName:["",i.kI.required],password:["",i.kI.required]})}get f(){return this.loginForm.controls}login(){const t=this.loginForm.get("userName").value,n=this.loginForm.get("password").value;this.loginForm.valid&&!this.loginForm.pending?this.authService.authenticate(t,n).subscribe(()=>{this.fromUrl?this.router.navigateByUrl(this.fromUrl):this.router.navigate(["user",t])},s=>{this.loginForm.reset(),this.platformDetectorService.isPlatformBrowser()&&setTimeout(()=>{this.userNameInput.nativeElement.focus()},1e3),alert(s.error.message)}):this.loginForm.markAllAsTouched()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(i.qu),e.Y36(F),e.Y36(l.F0),e.Y36(U),e.Y36(l.gz))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-signin"]],viewQuery:function(t,n){if(1&t&&e.Gf(w,5),2&t){let s;e.iGM(s=e.CRH())&&(n.userNameInput=s.first)}},decls:20,vars:5,consts:[[1,"text-center"],["autocomplete","off","novalidate","",1,"need-validation","mt-4",3,"formGroup","submit"],[1,"row","px-3"],[1,"col-12","mx-auto"],[1,"input-group","my-2"],["placeholder","nome de usu\xe1rio","formControlName","userName",1,"form-control","rounded-3"],["userNameInputs",""],[3,"field"],["type","password","placeholder","senha","formControlName","password",1,"form-control","rounded-3"],[1,"input-group","mb-2"],["type","submit",1,"btn","btn-primary","ms-auto"],[3,"routerLink"]],template:function(t,n){1&t&&(e.TgZ(0,"h4",0),e._uU(1,"Login"),e.qZA(),e.TgZ(2,"form",1),e.NdJ("submit",function(){return n.login()}),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4),e._UZ(6,"input",5,6)(8,"invalid-feedback",7),e.qZA(),e.TgZ(9,"div",4),e._UZ(10,"input",8)(11,"invalid-feedback",7),e.qZA(),e._UZ(12,"div"),e.TgZ(13,"div",9)(14,"button",10),e._uU(15," Login "),e.qZA()(),e.TgZ(16,"p",0),e._uU(17,"Ainda n\xe3o \xe9 usu\xe1rio? "),e.TgZ(18,"a",11),e._uU(19,"Cadastre-se agora"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",n.loginForm),e.xp6(6),e.Q6J("field",n.f.userName),e.xp6(3),e.Q6J("field",n.f.password),e.xp6(7),e.Q6J("routerLink",e.DdM(4,C)))},dependencies:[i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,h.h,l.yS],encapsulation:2}),r})();class S{static validadorPadrao(o,t){return n=>n.value?o.test(n.value)?null:t:null}static validadorSenhasIguais(o){o.get("senha").value!==o.get("confirmacaoSenha").value&&o.get("confirmacaoSenha").setErrors({doNotMatch:!0})}static fullName(o){const n=new RegExp("[ ]{2,}");let s;if(o.value&&(s=o.value.substr(o.value.length-1)),s&&n.test(o.value)&&o.setValue(o.value.slice(0,o.value.length-1)),!s||/^[a-z\xe1\xe0\xe2\xe3\xe9\xe8\xea\xed\xef\xf3\xf4\xf5\xf6\xfa\xe7\xf1' ]+$/i.test(s))return null;{const u=o.value.replace(s,"");o.setValue(u)}}static Password(o){if(null==o.value)return o;let t=!0;return/^(?=.*\d)(?=.*[$&+=?@#|'<>.^*()%!-])[A-Za-z\d$&+=?@#|'<>.^*()%!-]{6,12}$/.test(o.value)||(t=!1),t?null:{invalidPassword:!0}}static validadorEmail(o){return o.value.match(/^[\w]{1,}[\w.+-]{0,}@[\w-]{1,}([.][a-zA-Z]{2,}|[.][\w-]{2,}[.][a-zA-Z]{2,})$/)?null:{email:!0}}static lowerCaseValidator(o){return o.value.trim()&&!/^[a-z0-9_\-]+$/.test(o.value)?{lowerCase:!0}:null}static emailValidator(o){return o.value.trim()&&!/'^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$'/.test(o.value)?{email:!0}:null}}const A=r=>{const o=r.getRawValue(),t=o.userName,n=o.password,s=r.controls.password;let u=null;if(!(t.trim()+n.trim()&&t==n))return u;u={userNamePassword:!0},s.setErrors(u)};var I=a(5243),b=a(3900),L=a(4004),J=a(590);let p=(()=>{class r{constructor(t){this.http=t,this.endpoint="user"}checkUserNameTaken(t){return this.http.get(`${m.N.API_URL}/${this.endpoint}/exists/${t}`)}signup(t){return this.http.post(`${m.N.API_URL}/${this.endpoint}/signup`,t)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(v.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac}),r})(),N=(()=>{class r{constructor(t){this.signUpService=t}checkUserNameTaken(){return t=>t.valueChanges.pipe((0,I.b)(300)).pipe((0,b.w)(n=>this.signUpService.checkUserNameTaken(n))).pipe((0,L.U)(n=>n?{userNameTaken:!0}:null)).pipe((0,J.P)())}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(p))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac}),r})();function x(r,o){1&r&&(e.TgZ(0,"div",14),e._uU(1,"Usu\xe1rio dispon\xedvel"),e.qZA())}const z=function(){return[""]},E=[{path:"",component:k,canActivate:[g],children:[{path:"",component:y,canActivate:[g],data:{title:"Login"}},{path:"signup",component:(()=>{class r{constructor(t,n,s,u){this.fb=t,this.userNotTakenValidatorService=n,this.signupService=s,this.router=u}ngOnInit(){this.signupForm=this.fb.group({email:["",i.kI.compose([i.kI.required,i.kI.email,S.validadorEmail])],fullName:["",[i.kI.required,i.kI.minLength(2),i.kI.maxLength(40)]],userName:["",i.kI.compose([i.kI.required,S.lowerCaseValidator,i.kI.minLength(2),i.kI.maxLength(30)]),this.userNotTakenValidatorService.checkUserNameTaken()],password:["",[i.kI.required,i.kI.minLength(8),i.kI.maxLength(14)]]},{validator:A})}get f(){return this.signupForm.controls}signup(){const t=this.signupForm.getRawValue();this.signupForm.valid&&!this.signupForm.pending?this.signupService.signup(t).subscribe(()=>this.router.navigate([""]),n=>console.log(n)):this.signupForm.markAllAsTouched()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(i.qu),e.Y36(N),e.Y36(p),e.Y36(l.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-signup"]],features:[e._Bn([N])],decls:25,vars:8,consts:[[1,"text-center"],["autocomplete","off","novalidate","",1,"need-validation","mt-4",3,"formGroup","submit"],[1,"row","px-3"],[1,"col-12","mx-auto"],[1,"input-group","my-2"],["placeholder","E-mail","formControlName","email",1,"form-control","rounded-3"],[3,"field"],["placeholder","Nome Completo","formControlName","fullName",1,"form-control","rounded-3"],["placeholder","Nome de usu\xe1rio","formControlName","userName",1,"form-control","rounded-3"],["class","d-block valid-feedback",4,"ngIf"],["type","password","placeholder","Senha","formControlName","password",1,"form-control","rounded-3"],[1,"input-group","mb-2"],["type","submit",1,"btn","btn-primary","ms-auto"],[3,"routerLink"],[1,"d-block","valid-feedback"]],template:function(t,n){1&t&&(e.TgZ(0,"h4",0),e._uU(1," Registre-se"),e.qZA(),e.TgZ(2,"form",1),e.NdJ("submit",function(){return n.signup()}),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4),e._UZ(6,"input",5)(7,"invalid-feedback",6),e.qZA(),e.TgZ(8,"div",4),e._UZ(9,"input",7)(10,"invalid-feedback",6),e.qZA(),e.TgZ(11,"div",4),e._UZ(12,"input",8)(13,"invalid-feedback",6),e.YNc(14,x,2,0,"div",9),e.qZA(),e.TgZ(15,"div",4),e._UZ(16,"input",10)(17,"invalid-feedback",6),e.qZA(),e.TgZ(18,"div",11)(19,"button",12),e._uU(20,"Registrar"),e.qZA()(),e.TgZ(21,"p",0),e._uU(22,"J\xe1 \xe9 um usu\xe1rio? "),e.TgZ(23,"a",13),e._uU(24,"Login"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",n.signupForm),e.xp6(5),e.Q6J("field",n.f.email),e.xp6(3),e.Q6J("field",n.f.fullName),e.xp6(3),e.Q6J("field",n.f.userName),e.xp6(1),e.Q6J("ngIf",n.signupForm.get("userName").valid),e.xp6(3),e.Q6J("field",n.f.password),e.xp6(6),e.Q6J("routerLink",e.DdM(7,z)))},dependencies:[c.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,h.h,l.yS],encapsulation:2}),r})(),data:{title:"Cadastre-se"}}]}];let Y=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[l.Bz.forChild(E),l.Bz]}),r})(),P=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[p],imports:[c.ez,i.u5,i.UX,Z.m,l.Bz,Y]}),r})()}}]);